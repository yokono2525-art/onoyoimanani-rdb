# ローカル開発環境セットアップガイド

## 概要
「いまなにしてる？」タイムラインアプリのローカル開発環境のセットアップと運用方法について説明します。

## 前提条件
- Node.js 22以上がインストールされていること
- npm または yarn が利用可能であること

## セットアップ手順

### 1. 依存関係のインストール
```bash
npm install
```

### 2. サーバーの起動
```bash
npm start
# または
npm run dev
```

### 3. アプリケーションへのアクセス
ブラウザで以下のURLにアクセスしてください：
```
http://localhost:3000
```

## プロジェクト構成

```
src/
├── server.js      # Express.jsサーバー
├── index.html     # フロントエンド（HTML/CSS/JavaScript）
└── ...

timeline.db        # SQLiteデータベース（自動生成）
package.json       # プロジェクト設定
```

## データベース

### SQLiteデータベース
- ファイル名: `timeline.db`
- テーブル: `posts` (id, author, content, timestamp)
- sqlite3ライブラリを使用（Node.js 24対応）
- 自動的にインデックスが作成され、パフォーマンスが最適化されています

### データの永続化
- サーバーを停止してもデータは保持されます
- サーバー再起動時に前回のデータが引き継がれます

## API エンドポイント

### GET /api/posts
- 最新1000件の投稿を取得
- レスポンス: JSON配列

### POST /api/posts
- 新規投稿を作成
- リクエストボディ: `{ "author": "ユーザー名", "content": "投稿内容" }`
- レスポンス: 作成された投稿のJSON

## 機能

### ログイン機能
- 名前入力によるログイン
- クッキーによるログイン状態の保持（30日間）
- ログアウト機能

### タイムライン機能
- 50文字制限の投稿
- リアルタイム更新（3秒おきのポーリング）
- 最新1000件の表示制限
- 美しいUI/UX

## 開発・運用

### サーバーの再起動
```bash
# Ctrl+C でサーバーを停止
# 再度起動
npm start
```

### データベースのリセット
データベースをリセットしたい場合は、`timeline.db` ファイルを削除してください：
```bash
rm timeline.db
# サーバー再起動時に新しいデータベースが作成されます
```

### ログの確認
サーバーのコンソール出力で以下の情報を確認できます：
- サーバー起動メッセージ
- API リクエストのエラーログ
- データベース操作のエラーログ

## トラブルシューティング

### よくある問題

1. **ポート3000が使用中**
   - 他のアプリケーションがポート3000を使用している可能性があります
   - `PORT=3001 npm start` で別のポートを使用できます

2. **データベースファイルの権限エラー**
   - `timeline.db` ファイルの書き込み権限を確認してください

3. **依存関係のインストールエラー**
   - Node.js のバージョンが22以上であることを確認してください
   - `npm cache clean --force` でキャッシュをクリアしてから再インストールしてください

### パフォーマンス
- 3万件の投稿でも快適に動作するよう設計されています
- SQLiteのインデックスにより高速な検索が可能です
- 最新1000件の制限によりメモリ使用量を最適化しています

## 本番環境への展開
将来的にVercelなどへの展開を予定している場合は、`src` ディレクトリをルートディレクトリとして設定してください。

## サポート
問題が発生した場合は、サーバーのコンソール出力を確認し、エラーメッセージを記録してください。
